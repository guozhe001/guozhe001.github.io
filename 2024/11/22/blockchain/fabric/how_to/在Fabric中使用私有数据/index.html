<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="在Fabric中使用私有数据 官方文档：Using Private Data in Fabric This tutorial will demonstrate the use of Private Data Collections (PDC) to provide storage and retrieval of private data on the blockchain network for">
<meta property="og:type" content="article">
<meta property="og:title" content="在Fabric中使用私有数据">
<meta property="og:url" content="https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/index.html">
<meta property="og:site_name" content="滴水成涓">
<meta property="og:description" content="在Fabric中使用私有数据 官方文档：Using Private Data in Fabric This tutorial will demonstrate the use of Private Data Collections (PDC) to provide storage and retrieval of private data on the blockchain network for">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-11-22T06:32:06.494Z">
<meta property="article:modified_time" content="2024-11-22T06:32:06.494Z">
<meta property="article:author" content="guozhe">
<meta property="article:tag" content="blockchain">
<meta property="article:tag" content="Hyperledger-Fabric">
<meta property="article:tag" content="Secured">
<meta property="article:tag" content="Private Data">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>在Fabric中使用私有数据</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="滴水成涓" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/guozhe001">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2024/11/22/blockchain/fabric/how_to/Hyperledger-Fabric%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2024/11/22/blockchain/fabric/how_to/%E7%BC%96%E5%86%99%E6%82%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAChaincode/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&text=在Fabric中使用私有数据"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&is_video=false&description=在Fabric中使用私有数据"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=在Fabric中使用私有数据&body=Check out this article: https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&name=在Fabric中使用私有数据&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&t=在Fabric中使用私有数据"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE"><span class="toc-number">1.</span> <span class="toc-text">在Fabric中使用私有数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Asset-transfer-private-data-sample-use-case%EF%BC%88%E8%B5%84%E4%BA%A7%E8%BD%AC%E7%A7%BB%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E6%A0%B7%E4%BE%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">Asset transfer private data sample use case（资产转移私有数据样例使用方法）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-a-collection-definition-JSON-file%EF%BC%88%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%9B%86%E5%90%88%E5%AE%9A%E4%B9%89JSON%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">Build a collection definition JSON file（构建一个集合定义JSON文件）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-and-Write-private-data-using-chaincode-APIs%EF%BC%88%E4%BD%BF%E7%94%A8chaincode-API%E8%AF%BB%E5%86%99%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">Read and Write private data using chaincode APIs（使用chaincode API读写私有数据）</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        在Fabric中使用私有数据
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">guozhe</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-22T06:32:06.494Z" itemprop="datePublished">2024-11-22</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/">blockchain</a> › <a class="category-link" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/Hyperledger-Fabric/">Hyperledger-Fabric</a> › <a class="category-link" href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/Hyperledger-Fabric/HOW-TO/">HOW-TO</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Hyperledger-Fabric/" rel="tag">Hyperledger-Fabric</a>, <a class="tag-link-link" href="/tags/Private-Data/" rel="tag">Private Data</a>, <a class="tag-link-link" href="/tags/Secured/" rel="tag">Secured</a>, <a class="tag-link-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">blockchain</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="在Fabric中使用私有数据">在Fabric中使用私有数据</h1>
<p>官方文档：<a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html">Using Private Data in Fabric</a></p>
<p>This tutorial will demonstrate the use of Private Data Collections (PDC) to provide storage and retrieval of private data on the blockchain network for authorized peers of organizations. The collection is specified using a collection definition file containing the policies governing that collection.</p>
<p>本教程将演示如何使用私有数据集（PDC）为组织的有权限的peer在区块链网络上提供私有数据的存储和检索。使用包含定义该PDC策略的集合定义文件来管理PDC。</p>
<p>The information in this tutorial assumes knowledge of private data stores and their use cases. For more information, check out <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private-data/private-data.html">Private data</a>.</p>
<p>本教程中的信息假定您了解私有数据存储及其使用案例。有关更多信息，请查看<a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private-data/private-data.html">Private data</a>。</p>
<p>The tutorial will take you through the following steps to practice defining, configuring and using private data with Fabric:</p>
<p>本教程将指导您完成以下步骤，以练习定义、配置和使用Fabric私有数据：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-use-case">Asset transfer private data sample use case</a> 资产转移私有数据样例使用方法</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-build-json">Build a collection definition JSON file</a> 构建一个集合定义JSON文件</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-read-write-private-data">Read and Write private data using chaincode APIs</a> 使用chaincode API读写私有数据</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-install-define-cc">Deploy the private data smart contract to the channel</a> 部署私有数据智能合约到通道</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-register-identities">Register identities</a> 注册身份</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-store-private-data">Create an asset in private data</a> 在私有数据集中创建资产</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-query-authorized">Query the private data as an authorized peer</a> 通过有权限的peer查询私有数据</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-query-unauthorized">Query the private data as an unauthorized peer</a> 通过没有权限的peer查询私有数据</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-transfer-asset">Transfer the Asset</a> 交易在私有数据集中的资产</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-purge">Purge Private Data</a> 清除私有数据</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-indexes">Using indexes with private data</a> 对私有数据使用索引</li>
<li><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/private_data_tutorial.html#pd-ref-material">Additional resources</a> 额外资源</li>
</ol>
<p>This tutorial will deploy the <a target="_blank" rel="noopener" href="https://github.com/hyperledger/fabric-samples/tree/master/asset-transfer-private-data/chaincode-go">asset transfer private data sample</a> to the Fabric test network to demonstrate how to create, deploy, and use a collection of private data. You should have completed the task <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/install.html">Install Samples, Binaries, and Docker Images</a>.</p>
<p>这个教程会部署 <a target="_blank" rel="noopener" href="https://github.com/hyperledger/fabric-samples/tree/master/asset-transfer-private-data/chaincode-go">asset transfer private data sample</a>到Fabric的测试网络来演示如何创建、部署以及使用PDC。</p>
<h2 id="Asset-transfer-private-data-sample-use-case（资产转移私有数据样例使用方法）">Asset transfer private data sample use case（资产转移私有数据样例使用方法）</h2>
<p>This sample demonstrates the use of three private data collections, <code>assetCollection</code>, <code>Org1MSPPrivateCollection</code> &amp; <code>Org2MSPPrivateCollection</code> to transfer an asset between Org1 and Org2, using following use case:</p>
<p>这个样例使用以下用例演示使用三个私有数据集（PDC）来在Org1和Org2组织之间交易资产；这三个PDC为：<code>assetCollection</code>, <code>Org1MSPPrivateCollection</code> &amp; <code>Org2MSPPrivateCollection</code> 。</p>
<p>A member of Org1 creates a new asset, henceforth referred as owner. The public details of the asset, including the identity of the owner, are stored in the private data collection named <code>assetCollection</code>. The asset is also created with an appraised value supplied by the owner. The appraised value is used by each participant to agree to the transfer of the asset, and is only stored in owner organization’s collection. In our case, the initial appraisal value agreed by the owner is stored in the <code>Org1MSPPrivateCollection</code>.</p>
<p>组织Org1的一个成员创建一个新的资产，并拥有这个资产。公共的资产详情，包括拥有者的身份被存储在称作 <code>assetCollection</code>的私有数据集中。资产所有者也会为这个资产创建一个评估价值，通道上的每个参与者都使用这个评估价值来同意资产转让，并且它仅存储在所有者组织的集合中。在我们的案例中，所有者确认的初始评估值存储在<code>Org1MSPPrivateCollection</code>中。</p>
<p>To purchase the asset, the buyer needs to agree to the same appraised value as the asset owner. In this step, the buyer (a member of Org2) creates an agreement to trade and agree to an appraisal value using smart contract function <code>'AgreeToTransfer'</code>. This value is stored in <code>Org2MSPPrivateCollection</code> collection. Now, the asset owner can transfer the asset to the buyer using smart contract function <code>'TransferAsset'</code>. The <code>'TransferAsset'</code> function uses the hash on the channel ledger to confirm that the owner and the buyer have agreed to the same appraised value before transferring the asset.</p>
<p>要购买资产，购买者需要同意与资产所有者相同的评估价值。在此步骤中，买方（Org2的成员）使用智能合约的<code>“AgreeToTransfer”</code>方法来创建交易协议并同意评估价值。此值存储在<code>Org2MSPPrivateCollection</code>集合中。现在资产的拥有者可以通过智能合约中的<code>'TransferAsset'</code>方法来交易资产了。 <code>'TransferAsset'</code> 方法在转让资产之前先使用通道账本上的hash来验证买卖双方已经对相同的评估价格达成了一致。</p>
<p>Before we go through the transfer scenario, we will discuss how organizations can use private data collections in Fabric.</p>
<p>在此之前，我们将讨论组织如何在Fabric中使用私有数据集合。</p>
<h2 id="Build-a-collection-definition-JSON-file（构建一个集合定义JSON文件）">Build a collection definition JSON file（构建一个集合定义JSON文件）</h2>
<p>Before a set of organizations can transact using private data, all organizations on channel need to build a collection definition file that defines the private data collections associated with each chaincode. Data that is stored in a private data collection is only distributed to the peers of certain organizations instead of all members of the channel. The collection definition file describes all of the private data collections that organizations can read and write to from a chaincode.</p>
<p>在一组组织可以使用私有数据进行交易之前，通道上的所有组织需要构建一个集合定义文件，这个文件定义与每个链码关联的私有数据集合。存储在私有数据集合中的数据仅分发给相同组织的peer节点，而不是分发给通道的所有成员。集合定义文件描述了组织可以通过链码读写的所有私有数据集。</p>
<p>Each collection is defined by the following properties:</p>
<ul>
<li><code>name</code>: Name of the collection.</li>
<li><code>policy</code>: Defines the organization peers allowed to persist the collection data.</li>
<li><code>requiredPeerCount</code>: Number of peers required to disseminate the private data as a condition of the endorsement of the chaincode</li>
<li><code>maxPeerCount</code>: For data redundancy purposes, the number of other peers that the current endorsing peer will attempt to distribute the data to. If an endorsing peer goes down, these other peers are available at commit time if there are requests to pull the private data.</li>
<li><code>blockToLive</code>: For very sensitive information such as pricing or personal information, this value represents how long the data should live on the private database in terms of blocks. The data will live for this specified number of blocks on the private database and after that it will get purged, making this data obsolete from the network. To keep private data indefinitely, that is, to never purge private data, set the <code>blockToLive</code> property to <code>0</code>.</li>
<li><code>memberOnlyRead</code>: a value of <code>true</code> indicates that peers automatically enforce that only clients belonging to one of the collection member organizations are allowed read access to private data.</li>
<li><code>memberOnlyWrite</code>: a value of <code>true</code> indicates that peers automatically enforce that only clients belonging to one of the collection member organizations are allowed write access to private data.</li>
<li><code>endorsementPolicy</code>: defines the endorsement policy that needs to be met in order to write to the private data collection. The collection level endorsement policy overrides to chaincode level policy. For more information on building a policy definition refer to the <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/endorsement-policies.html">Endorsement policies</a> topic.</li>
</ul>
<p>所有的集合都是用下面的属性来定义：</p>
<ul>
<li><code>name</code>: 集合名称</li>
<li><code>policy</code>: 定义允许持久化集合数据的组织的peer节点。</li>
<li><code>requiredPeerCount</code>: 传播私有数据所需的peer数目，以作为对链码的认可</li>
<li><code>maxPeerCount</code>: 为了数据冗余，当前合法peer将尝试向其分发数据的其他peer的数量。如果一个合法的peer挂了，如果有请求拉私有数据的请求，则这些其他peer在提交时可用。</li>
<li><code>blockToLive</code>: 对于如价格或个人信息这类非常敏感的信息，此值表示数据应在私有数据库的块上保存的时间。数据将在私有数据库块上保留指定的时间，然后清除，使该数据从网络上过时。要无限期保留私有数据，即从不清除私有数据，请将<code>blockToLive</code>属性设置为0。</li>
<li><code>memberOnlyRead</code>: 值为true表示peer节点自动强制只有属于集合成员组织的客户端才允许读取私有数据。</li>
<li><code>memberOnlyWrite</code>:值为true表示peer节点自动强制只有属于集合成员组织的客户端才允许写入私有数据。</li>
<li><code>endorsementPolicy</code>: 定义了写入私有数据集合需要满足的认可策略。集合级别的背书策略会覆盖chaincode级别的策略。有关构建策略定义的更多信息，请参考 <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/endorsement-policies.html">Endorsement policies</a>主题。</li>
</ul>
<p>The same collection definition file needs to be deployed by all organizations that use the chaincode, even if the organization does not belong to any collections. In addition to the collections that are explicitly defined in a collection file, each organization has access to an implicit collection on their peers that can only be read by their organization. For an example that uses implicit data collections, see the <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/secured_asset_transfer/secured_private_asset_transfer_tutorial.html">Secured asset transfer in Fabric</a>.</p>
<p>所有使用同一个chaincode的组织都要部署相同的集合定义文件，即使这个组织不属于任何集合。除了在集合文件中显式定义的集合之外，每个组织都可以访问其peer节点上的隐式集合，这些隐式集合只能由其组织读取。使用隐式数据集的例子可以看<a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/secured_asset_transfer/secured_private_asset_transfer_tutorial.html">Secured asset transfer in Fabric</a>。</p>
<p>The asset transfer private data example contains a collections_config.json file that defines three private data collection definitions: <code>assetCollection</code>, <code>Org1MSPPrivateCollection</code>, and <code>Org2MSPPrivateCollection</code>.</p>
<p>资产转移私有数据的示例包含一个collections_config.json文件，该文件定义了三个私有数据集合定义：<code>assetCollection</code>, <code>Org1MSPPrivateCollection</code>, and <code>Org2MSPPrivateCollection</code>。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// collections_config.json</span></span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">   &#123;</span><br><span class="line">   <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;assetCollection&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;policy&quot;</span>: <span class="string">&quot;OR(&#x27;Org1MSP.member&#x27;, &#x27;Org2MSP.member&#x27;)&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;requiredPeerCount&quot;</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">&quot;maxPeerCount&quot;</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">&quot;blockToLive&quot;</span>:<span class="number">1000000</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyRead&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyWrite&quot;</span>: <span class="literal">true</span></span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">   <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Org1MSPPrivateCollection&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;policy&quot;</span>: <span class="string">&quot;OR(&#x27;Org1MSP.member&#x27;)&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;requiredPeerCount&quot;</span>: <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;maxPeerCount&quot;</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">&quot;blockToLive&quot;</span>:<span class="number">3</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyRead&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyWrite&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">&quot;endorsementPolicy&quot;</span>: &#123;</span><br><span class="line">       <span class="attr">&quot;signaturePolicy&quot;</span>: <span class="string">&quot;OR(&#x27;Org1MSP.member&#x27;)&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">   <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Org2MSPPrivateCollection&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;policy&quot;</span>: <span class="string">&quot;OR(&#x27;Org2MSP.member&#x27;)&quot;</span>,</span><br><span class="line">   <span class="attr">&quot;requiredPeerCount&quot;</span>: <span class="number">0</span>,</span><br><span class="line">   <span class="attr">&quot;maxPeerCount&quot;</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">&quot;blockToLive&quot;</span>:<span class="number">3</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyRead&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">&quot;memberOnlyWrite&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">   <span class="attr">&quot;endorsementPolicy&quot;</span>: &#123;</span><br><span class="line">       <span class="attr">&quot;signaturePolicy&quot;</span>: <span class="string">&quot;OR(&#x27;Org2MSP.member&#x27;)&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line">   &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>The <code>policy</code> property in the <code>assetCollection</code> definition specifies that both Org1 and Org2 can store the collection on their peers. The <code>memberOnlyRead</code> and <code>memberOnlyWrite</code> parameters are used to specify that only Org1 and Org2 clients can read and write to this collection.</p>
<p><code>assetCollection</code>定义中的<code>policy</code>属性指定Org1和Org2都可以在其peer节点上存储集合。 <code>memberOnlyRead</code> 和 <code>memberOnlyWrite</code> 参数被用于指定只有Org1和Org2的客户端可以读写这个集合。</p>
<p>The <code>Org1MSPPrivateCollection</code> collection allows only peers of Org1 to have the private data in their private database, while the <code>Org2MSPPrivateCollection</code> collection can only be stored by the peers of Org2. The <code>endorsementPolicy</code> parameter is used to create a collection specific endorsement policy. Each update to <code>Org1MSPPrivateCollection</code> or <code>Org2MSPPrivateCollection</code> needs to be endorsed by the organization that stores the collection on their peers. We will see how these collections are used to transfer the asset in the course of the tutorial.</p>
<p><code>Org1MSPPrivateCollection</code> 集合只允许Org1的peer节点在他们的私有数据库中拥有私有数据，而<code>Org2MSPPrivateCollection</code>集合只能由Org2的peer节点存储。 <code>endorsementPolicy</code> 参数用于创建特定集合的认可策略。对<code>Org1MSPPrivateCollection</code>或<code>Org2MSPPrivateCollection</code>的每次更新都需要由将集合存储在其peer节点的组织认可。在本教程中，我们将了解如何使用这些集合来转移资产。</p>
<p>This collection definition file is deployed when the chaincode definition is committed to the channel using the <a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/commands/peerlifecycle.html#peer-lifecycle-chaincode-commit">peer lifecycle chaincode commit command</a>. More details on this process are provided in Section 3 below.</p>
<p>这个集合定义文件是在使用<a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/commands/peerlifecycle.html#peer-lifecycle-chaincode-commit">peer lifecycle chaincode commit command</a>把链码定义提交到通道时被部署的。</p>
<h2 id="Read-and-Write-private-data-using-chaincode-APIs（使用chaincode-API读写私有数据）">Read and Write private data using chaincode APIs（使用chaincode API读写私有数据）</h2>
<p>The next step in understanding how to privatize data on a channel is to build the data definition in the chaincode. The asset transfer private data sample divides the private data into three separate data definitions according to how the data will be accessed.</p>
<p>下一步是了解如何在链码中建立数据定义来对通道上的数据进行私有化。资产转移私有数据实例根据访问数据的方式将私有数据分为三个单独的数据定义。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Peers in Org1 and Org2 will have this private data in a side database</span></span><br><span class="line"><span class="keyword">type</span> Asset <span class="keyword">struct</span> &#123;</span><br><span class="line">       Type  <span class="keyword">string</span> <span class="string">`json:&quot;objectType&quot;`</span> <span class="comment">//Type is used to distinguish the various types of objects in state database</span></span><br><span class="line">       ID    <span class="keyword">string</span> <span class="string">`json:&quot;assetID&quot;`</span></span><br><span class="line">       Color <span class="keyword">string</span> <span class="string">`json:&quot;color&quot;`</span></span><br><span class="line">       Size  <span class="keyword">int</span>    <span class="string">`json:&quot;size&quot;`</span></span><br><span class="line">       Owner <span class="keyword">string</span> <span class="string">`json:&quot;owner&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AssetPrivateDetails describes details that are private to owners</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Only peers in Org1 will have this private data in a side database</span></span><br><span class="line"><span class="keyword">type</span> AssetPrivateDetails <span class="keyword">struct</span> &#123;</span><br><span class="line">       ID             <span class="keyword">string</span> <span class="string">`json:&quot;assetID&quot;`</span></span><br><span class="line">       AppraisedValue <span class="keyword">int</span>    <span class="string">`json:&quot;appraisedValue&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only peers in Org2 will have this private data in a side database</span></span><br><span class="line"><span class="keyword">type</span> AssetPrivateDetails <span class="keyword">struct</span> &#123;</span><br><span class="line">       ID             <span class="keyword">string</span> <span class="string">`json:&quot;assetID&quot;`</span></span><br><span class="line">       AppraisedValue <span class="keyword">int</span>    <span class="string">`json:&quot;appraisedValue&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Specifically, access to the private data will be restricted as follows:</p>
<ul>
<li><code>objectType, color, size, and owner</code> are stored in <code>assetCollection</code> and hence will be visible to members of the channel per the definition in the collection policy (Org1 and Org2).</li>
<li><code>AppraisedValue</code> of an asset is stored in collection <code>Org1MSPPrivateCollection</code> or <code>Org2MSPPrivateCollection</code> , depending on the owner of the asset. The value is only accessible to the users who belong to the organization that can store the collection.</li>
</ul>
<p>具体来说，对私有数据的访问将受到以下限制：</p>
<ul>
<li><code>objectType, color, size, and owner</code> 被存储在 <code>assetCollection</code> 因此，根据集合策略中的定义，这些数据对通道上的Org1和Org2是可以访问的。</li>
<li>资产的评估价值被存储在 <code>Org1MSPPrivateCollection</code> 或 <code>Org2MSPPrivateCollection</code> 集合中，取决于资产的所有者。只有属于可以存储集合的组织的用户才能访问该评估值。</li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/guozhe001">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE"><span class="toc-number">1.</span> <span class="toc-text">在Fabric中使用私有数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Asset-transfer-private-data-sample-use-case%EF%BC%88%E8%B5%84%E4%BA%A7%E8%BD%AC%E7%A7%BB%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%E6%A0%B7%E4%BE%8B%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">Asset transfer private data sample use case（资产转移私有数据样例使用方法）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Build-a-collection-definition-JSON-file%EF%BC%88%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%9B%86%E5%90%88%E5%AE%9A%E4%B9%89JSON%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">Build a collection definition JSON file（构建一个集合定义JSON文件）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-and-Write-private-data-using-chaincode-APIs%EF%BC%88%E4%BD%BF%E7%94%A8chaincode-API%E8%AF%BB%E5%86%99%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">Read and Write private data using chaincode APIs（使用chaincode API读写私有数据）</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&text=在Fabric中使用私有数据"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&is_video=false&description=在Fabric中使用私有数据"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=在Fabric中使用私有数据&body=Check out this article: https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&title=在Fabric中使用私有数据"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&name=在Fabric中使用私有数据&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://guozhe001.github.io/2024/11/22/blockchain/fabric/how_to/%E5%9C%A8Fabric%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%A7%81%E6%9C%89%E6%95%B0%E6%8D%AE/&t=在Fabric中使用私有数据"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2024
    guozhe
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/categories/">分类</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/guozhe001">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
